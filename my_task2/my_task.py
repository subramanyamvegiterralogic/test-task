import plotly.graph_objects as go
# import openpyxl
# wb = openpyxl.load_workbook('heat_map_task.xlsx')
# sheet = wb.active
# data = []
# for value in sheet.iter_rows(min_row=3, max_row=30, min_col=1, max_col=3, values_only= True):
#     print(type(value))
#     if value[0] is not None:
#         data.append(value)
# print(data)
import plotly.figure_factory as ff
z_old = [[80, 80, 80, 20, 20, 20, 40, 40, 0, 0, 0, 0],
     [80, 80, 80, 20, 20, 20, 40, 40, 0, 0, 0, 0],
     [80, 80, 80, 75, 75, 75, 75, 75, 0, 0, 0, 0],
     [80, 80, 80, 75, 75, 75, 75, 75, 0, 0, 0, 0],
     [50, 50, 50, 75, 75, 75, 75, 75, 0, 0, 0, 0],
     [50, 50, 50, 75, 75, 75, 75, 75, 0, 0, 0, 0],
     [50, 50, 50, 75, 75, 75, 10, 10, 0, 0, 0, 0],
     [50, 50, 50, 75, 75, 75, 10, 10, 0, 0, 0, 0],
     [90, 90, 90, 90, 20, 20, 10, 10, 0, 0, 0, 0],
     [90, 90, 90, 90, 20, 20, 30, 30, 0, 0, 0, 0],
     [90, 90, 90, 90, 20, 20, 30, 30, 0, 0, 0, 0],
     [90, 90, 90, 90, 20, 20, 30, 30, 0, 0, 0, 0]]


x = [x for x in range(1, 18, 1)]
y = [y for y in range(1, 8, 1)]
z_text_old = [['', '', '', '', '', '', '', '', 'Node JS (1)', 'Influx DB (1)','',''],
          ['', '', '', '', 'Robot Framework (6)', '', 'ELK (2)', 'Optical (20', 'ML (1)', ' PHP (1)', '', ''],
          ['', 'MySql (12)', '', '', '', '', '', '', '', '', '', ''],
          ['', '', '', '', '', '','Web QA (2)', 'API QA (2)', 'Kubernetes (2)', 'IOT (2)', '', ''],
          ['', '', '', '', 'Warrior Framework (9)', '', '', '', '', '', '', ''],
          ['', '', '', '', '', '', 'L2/L3 (4)', '', 'Dockers (4)', '',  '', ''],
          ['', '', '', '', '', '', '', '', '', '', '', ''],
          ['', 'Mongo DB(12)', '', '', 'Java (9)', '', 'Jenkins (6)', '', 'AWS (4)',  '', '', ''],
          ['', '', '', '', '', '', '', '', '', '', '', ''],
          ['', '', '', '', '', '', '', '', 'Angular JS (4)', '', '', ''],
          ['','Python(16)','','','Kafka(8)','','DJango (6)','','','','','',],
          ['', '', '', '', '', '', '', '', 'Spring Boot (4)', '', '', '']]
          
z_new =[[90, 90, 90, 90, 90, 90, 90, 75, 75, 85, 85, 85, 75, 90, 90, 90, 90],
        [90, 90, 90, 90, 90, 90, 90, 75, 75, 85, 85, 85, 75, 90, 90, 90, 90],
        [85, 85, 85, 85, 85, 85, 85, 75, 75, 85, 85, 85, 75, 90, 90, 90, 90],
        [85, 85, 85, 85, 85, 85, 85, 75, 75, 80, 80, 80, 75, 90, 90, 90, 90],
        [85, 85, 85, 85, 85, 85, 85, 75, 75, 80, 80, 80, 75, 75, 75, 75, 75],
        [90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 85, 85, 85, 75],
        [85, 85, 85, 85, 85, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 75, 75]]

z_text_new = [['','','','','','','','','','','','','','','','',''],
         ['','','MySql/Postgress SQL','','','','','L2/L3','','','Java','','ELK','','','Python',''],
         ['','','Messaging Kafka','','','','','','','','','','','','','',''],
         ['','','Robot Framework','','','','','Kubernetes','Dockers','','','','Influx DB','','','',''],
         ['','','DJango','','','','','','','','Jenkins','','','','IOT','','AL ML Stack'],
         ['','','','','','','Mongo DB','','','','','','','','Angular JS','','Node JS'],
         ['','','Spring Boot','','','','','AWS/Cloud','','','','Optical','','QA-API Automation','','','QA-Web Automation']]
#fig = go.Figure(data=go.Heatmap(z=z, x=x, y=y,colorscale='Greens',text=z_text))
fig = ff.create_annotated_heatmap(z_new, x=x, y=y, annotation_text=z_text_new, colorscale='Greens' )
fig.show()
